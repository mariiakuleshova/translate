# Самостоятельная классификация деревьев решений и инструменты ИИ

  
Раньше мы, люди истории, создавали эти деревья решений вручную. Мы даже не обсуждали, как написать программу, позволяющую роботу использовать деревья чтобы принимать решения. Разве не было бы намного лучше, если бы компьютер делал всю сложную часть в процессе создания дерева вместо нас: определял ветви и помечал узлы? Это именно то, чем мы будем заниматься в этом разделе.

Давайте рассмотрим проблему классификации игрушек. Мы могли бы придумать более эффективного робота, который каким-то образом сортирует игрушки, а не просто складывает их в коробку. В идеальном мире, из 20 игрушек, мы бы разделили кучу игрушек поровну - 10 и 10. Допустим, наш критерий для классификации - это длина:  половина игрушек до шести дюймов в длину и половина длиннее. Тогда было бы также идеально, если бы какая-то другая характеристика делила каждую из этих куч по 10 игрушек пополам – то есть четыре группы по пять игрушек. Пусть это будет цвет - у нас есть пять красных игрушек, пять синих игрушек, пять зеленых игрушек и пять желтых игрушек. Очень хорошо и организованно. Вы можете признать, что мы делаем то, что делают биологи при классификации новых виды - мы создаем таксономию. Теперь мы выбираем другой атрибут, который отделяет игрушки на еще более мелкие группы - это может быть, характеристика того, какой тип у этой игрушки или какой у нее размер колес. Я думаю, вы поняли логику.

Давайте рассмотрим пример.

Теперь было бы здорово, если бы мы могли перечислить все игрушки и все атрибуты в таблице, и пусть компьютер выяснит, сколько групп и каких видов. Мы могли бы создать таблицу, подобную этой:

| Тип | Длина | Ширина | Вес | Цвет | Количество колес | Звуки | Уровень жесткости | Материал | Глаза | Имя игрушки |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| машинка | 3 | 1 | 35 | красный | 4 | 0 | жесткий | металл | 0 | HotWheels |
| машинка | 3 | 1 | 35 | оранжевый | 4 | 0 | жесткий | металл | 0 | HotWheels |
| машинка | 3 | 1 | 35 | голубой | 4 | 0 | жесткий | металл | 0 | HotWheels |
| машинка | 3 | 1 | 35 | голубой | 4 | 0 | жесткий | металл | 0 | HotWheels |
| машинка | 3 | 1 | 35 | белый | 4 | 0 | жесткий | металл | 0 | HotWheels |
| мягкая игрушка | 5 | 5 | 50 | белый | 0 | 0 | очень мягкий | мех | 2 | Plush |
| мягкая игрушка | 7 | 5 | 55 | коричневый | 0 | 0 | очень мягкий | мех | 3 | Plush |
| Для активных игр | 2 | 4 | 80 | серый | 0 | 0 | жесткий | метал | 0 | пружинка |
| Конструктор | 2 | 2 | 125 | деревянный | 0 | 0 | жесткий | дерево | 0 | деревянный блок 2х2 |
| Конструктор | 2 | 2 | 75 | деревянный | 0 | 0 | жесткий | дерево | 0 | треугольный деревянный блок |
| Конструктор | 4 | 2 | 250 | деревянный | 0 | 0 | жесткий | дерево | 0 | деревянный блок 4х2 |
| Посуда | 3 | 3 | 79 | голубой | 0 | 0 | жесткий | керамика | 0 | чайный сервиз |
| Самолет | 7 | 5 | 65 | белый | 4 | 1 | жесткий | пластик | 0 | космический корабль |
| Самолет | 13 | 7 | 500 | зеленый | 8 | 1 | жесткий | пластик | 0 | Thunderbird 2 |
| Машинка | 5 | 1 | 333 | желтый | 6 | 1 | жесткий | металл | 0 | школьный автобус |
| Музыкальная | 12 | 4 | 130 | деревянный | 0 | 2 | жесткий | дерево | 0 | гитара |
| Музыкальная | 5 | 2 | 100 | желтый | 0 | 1 | жесткий | пластик | 0 | микрофон |
| Музыкальная | 4 | 4 | 189 | белый | 0 | 2 | жесткий | дерево | 0 | барабан |

  
У нас есть проблема, которую мы должны решить. Мы будем использовать классификатор дерева решений, который поставляется с пакетом Scikit-Learn Python, который называется DecisionTreeClassifier. Эта программа не может использовать строки в качестве входных данных. Нам придется конвертировать все наши строковые данные в какую-то числовую форму. К счастью, люди из библиотеки Scikit предоставили нам функции с этой целью. На самом деле, они предоставили несколько кодировок функций, которые преобразуют строки в числа. Функция, которую мы будем использовать, называется LabelEncoder. Эта функция берет массив строк и преобразует его в перечисляемый набор целых чисел.

Мы можем взять нашу первую колонку, которая содержит тип игрушки. Мы должны превратить все типы в какие-то цифры.

LabelEncoder преобразует столбец в нашей таблице данных, заполненный строками.

Столбец типа игрушки показан в следующем коде:

